import org.gradle.api.internal.artifacts.publish.DefaultPublishArtifact

apply plugin: 'maven'
apply plugin: 'war'

//version = "1.0.1"
distsDirName="dist"
libsDirName="."
archivesBaseName="FileManager"
sourceCompatibility=1.8
targetCompatibility=1.8


configurations {
    compile
    gwt
}

dependencies {
    compile group: 'log4j', name: 'log4j', version: '1.2.16', ext: 'jar', transitive: true
    compile group: 'javax.faces', name: 'jsf-api', version: '1.2', ext: 'jar', transitive: true
    compile group: 'javax.faces', name: 'jsf-impl', version: '1.2_13', ext: 'jar', transitive: true
    compile group: 'jstl', name: 'jstl', version: '1.1.2', ext: 'jar', transitive: true
    compile group: 'jsfcl', name: 'jsfcl', version: '1.0', ext: 'jar', transitive: true
    compile group: 'com.sun.faces.extensions', name: 'jsf-extensions-common', version: '0.1', ext: 'jar', transitive: true
    compile group: 'com.sun.faces.extensions', name: 'jsf-extensions-dynamic-faces', version: '0.1', ext: 'jar', transitive: true
    compile group: 'com.sun.woodstock', name: 'webui-jsf', version: '4.2', ext: 'jar', transitive: true
    compile group: 'com.sun.woodstock', name: 'webui-jsf-suntheme', version: '4.2', ext: 'jar', transitive: true
    compile group: 'commons-io', name: 'commons-io', version: '1.4', ext: 'jar', transitive: true
    compile group: 'commons-net', name: 'commons-net', version: '1.4.1', ext: 'jar', transitive: true
    compile group: 'commons-fileupload', name: 'commons-fileupload', version: '1.2.1', ext: 'jar', transitive: true
    compile group: 'commons-beanutils', name: 'commons-beanutils', version: '1.8.2', ext: 'jar', transitive: true
    compile group: 'commons-collections', name: 'commons-collections', version: '3.2', ext: 'jar', transitive: true
    compile group: 'commons-digester', name: 'commons-digester', version: '2.0', ext: 'jar', transitive: true
    compile group: 'commons-logging', name: 'commons-logging', version: '1.0.4', ext: 'jar', transitive: true
    compile group: 'commons-net', name: 'commons-net', version: '1.4.1', ext: 'jar', transitive: true
    compile group: 'appbase', name: 'appbase', version: '1.0', ext: 'jar', transitive: true
    compile group: 'org.apache.tomcat', name: 'servlet-api', version: '6.0.29', ext: 'jar'
    compile group: 'taglibs', name: 'standard', version: '1.1.2', ext: 'jar'
    compile project(':libs:CoadunationLib')
    compile project(':libs:CoadunationAnnotations')
    compile project(':utils:CoadunationUtil')
    compile project(':client:EventServerClient')
    compile project(':client:MessageServiceClient')
}

sourceSets {
    main {
        java {
            srcDir './src/java'
        }
        resources {
            srcDir './src/java'
            srcDir './src/conf'
        }
    }
}

war {
    def classPath = getClasspath().filter({file -> file.name.contains("EventServerClient") || 
        file.name.contains("CoadunationUtil") || 
        file.name.contains("MessageServiceClient") || 
        file.name.contains("jsf-api") || 
        file.name.contains("jsf-impl") || 
        file.name.contains("jsf-extensions-common") || 
        file.name.contains("jsf-extensions-dynamic-faces") || 
        file.name.contains("commons-io") || 
        file.name.contains("commons-net") || 
        file.name.contains("commons-fileupload") || 
        file.name.contains("commons-beanutils") || 
        file.name.contains("commons-collection") || 
        file.name.contains("commons-digester") || 
        file.name.contains("commons-logging") || 
        file.name.contains("commons-net") || 
        file.name.contains("appbase") || 
        file.name.contains("webui-jsf") || 
        file.name.contains("webui-jsf-suntheme") || 
        file.name.contains("apache-taglibs")|| 
        file.name.contains("standard")|| 
        file.name.contains("jsfcl")|| 
        file.name.contains("jstl")}) 
    setClasspath(classPath)
    classpath 'build/classes/main/'
    from 'web'
}

artifacts {
    runtime war
}

release.dependsOn build
